<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ajax.html</title>
    <link rel="stylesheet" href="ajax.css">
    <!-- <script src="js/ajax.js"></script> -->
</head>

<body>
    <div class="title">
        <span id="id">id</span><strong id="name">first_name</strong><strong id="name">  last_name</strong><strong id=email>  e-mail</strong></div>
    <div id='show'></div>
    <div class="pagination">
        <button>1</button>
        <button>2</button>
        <button>3</button>
        <button>4</button>
        <button>5</button>
        <button>6</button>
        <button>7</button>
        <button>8</button>
        <button>9</button>
        <button>10</button>
        <button>16</button>
    </div>

    <script>
        function ajax(url, page) {
            // 기존에 있던 데이터를 화면삭제 후
            let divShow = document.querySelector('#show')
            let cnt = divShow.children.length;
            for (let i = 0; i < cnt; i++) {
                divShow.removeChild(divShow.children[0]);
            }
            let startCot, endCnt;
            startCot = (page - 1) * 10; //index: 0 ~9, 10~ 19
            endCnt = page * 10 - 1;

            let xhtp = new XMLHttpRequest();
            xhtp.open('get', url);
            xhtp.send();
            xhtp.onload = function () {
                let showDiv = document.getElementById('show')
                let data = JSON.parse(xhtp.responseText)
                let fData = data.filter(function (val, idx) {
                    if (startCot <= idx && idx <= endCnt) {
                        return val;
                    }
                }).forEach(function (val, idx) {
                    // span: id, strong: f_n, l_n, email
                    let span = document.createElement('span');
                    span.innerHTML = val.id;
                    let strong1 = document.createElement('strong');
                    strong1.innerHTML = val.first_name;
                    let strong2 = document.createElement('strong');
                    strong2.innerHTML = val.last_name;
                    let strong3 = document.createElement('strong');
                    strong3.innerHTML = val.email;
                    let div = document.createElement('div');
                    div.setAttribute('class', 'row');
                    //div하위요소에 span, strong1, strong2, strong3
                    div.appendChild(span);
                    div.appendChild(strong1);
                    div.appendChild(strong2);
                    div.appendChild(strong3);

                    showDiv.appendChild(div);
                });
                console.log(fData)
            }
        }
        ajax('MOCK_DATA.json', 1); //첫 화면에 첫페이지를 보여주기위해서

        let btns = document.querySelectorAll('.pagination > button');
        for (let i = 0; i < btns.length; i++) {
            btns[i].addEventListener('click', function () {
                for (let i = 0; i < btns.length; i++) {
                    btns[i].className = '';
                }
                this.className = 'active'
                let page = this.innerHTML;
                ajax('MOCK_DATA.json', page);
            })
        }
    </script>
</body>

</html>